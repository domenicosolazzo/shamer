{% extends "_leaderboard.html" %}
{% block extra %}
<hr>
<p>
  <h4>Goto Coverage Report</h4>
  <p>
    CI Build Number:
    <input type='text' id='ci_build_number'>
    <button type='button' id='ci_build_number_btn' class='btn btn-default'>Go!</button>
  </p>
</p>
{% endblock %}
{% block th %}
  <th data-sort="string">User</th>
  <th data-sort="float">Ruby Coverage</th>
  <th data-sort="float">JS Coverage</th>
{% endblock %}
{% block tb %}
  {% for user in leaderboard %}
    <tr
    href="{{ url_for('user_leaderboard_view', login=user.login) }}"
    {% if (user.contribution.rb + user.contribution.js) > 0 %}
      class="success"
    {% elif (user.contribution.rb + user.contribution.js) < 0 %}
      class="danger"
    {% endif %}
    >
      {% if user.name %}
      <td>{{ user.name }} ({{ user.login }})</td>
      {% else %}
      <td>{{ user.login }}</td>
      {% endif %}
      <td>{{ user.contribution.rb|round(2) }}%</td>
      <td>{{ user.contribution.js|round(2) }}%</td>
    </tr>
  {% endfor %}
{% endblock %}

{% block script %}
<script>
  $(document).ready(function() {
    $('#ci_build_number_btn').click(function() {
      ci_build_number = $('#ci_build_number').val();
      object_key = "dashboard/ci_build_number/coverage/index.html".replace('ci_build_number', ci_build_number);
      url = "{{ url_for('go_view', object_key='object_key') }}".replace('object_key', object_key);
      window.open(url + '?' + encodeURIComponent('CI Build #' + ci_build_number));
    });
  });
</script>
{% endblock %}
